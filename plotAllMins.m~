% ======================================================================
% This code written by R. Michael Winters
% Date created: February 16, 2016
%
%> @brief Plots all minimum values by color for each reference track.
%> called by :: searchAllNonZeroFrames
%>
%> @param fullResultsArray: The full results of min values
%> @param minValueVec: A 3 x numMinVals vector of the 
%>

% ======================================================================

function plotAllMins(results, minValVec, qFilename, rFilenames, q, numResultsToReturn)


resultsMins = results(3,:);

%sizeMinValVec = size(minValVec,2);

figure
plot(resultsMins);
hold on
mkrSize = 10;
mkrWidth = 1.6;
% Make a handle for each reference track
h = zeros(3,1);

% Do it for all results now
for i = 1:length(results(3,:));
    if results(1,i) == 1
        h(1) = plot(i, results(3,i), 'r+','MarkerSize',mkrSize, 'LineWidth', mkrWidth);
    elseif results(1,i) == 2
        h(2) = plot(i, results(3,i), 'go','MarkerSize',mkrSize, 'LineWidth', mkrWidth);
    elseif results(1,i) == 3
        h(3) = plot(i, results(3,i), 'm*','MarkerSize',mkrSize, 'LineWidth', mkrWidth);
    end
end

% Count all of the minima in each example
[a, b] = hist(results(1,:), unique(results(1,:)));

% For dealing with cases that there is 0 matches
if size(1,2) <  length(rFilenames)
    c = zeros(1,length(rFilenames));
    c(b) = a;
    for i = find(c==0)
        if i == 1
            h(i) = plot(i, results(3,i),'Marker','r+','Visible','off');
        elseif i == 2
            h(i) = plot(i, results(3,i),'Marker','go','Visible','off');
        elseif i == 3
            h(i) = plot(i, results(3,i),'Marker','m*', 'Visible','off');
        end
    end
end

% for i = find(c==0)
%     h(i) = plot(i, results(3,i),'Visible','off');
% end

% set(h(1),'Marker','+','Color',[1 0 0]);
% set(h(2),'Marker','o','Color',[0 1 0]); 
% set(h(3),'Marker','*','Color',[1 0 1]); 

hold off

% Format the plot
box on

% Prepend these results to the rFilenames to add to the legend
for i = 1:size(rFilenames,2)
    rFilenames{i} = [num2str(c(i)) ' ' rFilenames{i}];
end

a = legend(h,rFilenames)

xlabel('Non-Zero Frame')
ylabel('(Dis) Similarity')
title(['Best Matches for ' qFilename ' (Thresh = ' num2str(q.threshold) ', numDTW = ' num2str(numResultsToReturn*3) ')'])
hold off

htitle = ['Figures/numDTW_' num2str(numResultsToReturn*3) '.eps'];
saveas(gcf, htitle,'epsc');